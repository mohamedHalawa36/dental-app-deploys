import{ad as o,m as d,V as t,t as n,W as l,Y as w}from"./QueryClientProvider-D4Qhlzs_.js";const g=()=>{const{invalidCredentials:s}=d.error.auth;throw new o(s,400,"invalid_credentials")},m=async s=>await t.from("profiles").select().eq("id",s).single(),u=async s=>await t.from("profiles").select().eq("email",s).single(),h=async s=>{const{data:e,error:r,status:i}=await u(s.email);if(r)throw new o(r.message,i,r.code);(!e||!e.is_active)&&g();const{data:c,error:a}=await t.auth.signInWithPassword(s);if(a)throw new o(a.message,a.status,a.code);return{...c,userProfile:e}},p=async()=>{const{error:s}=await t.auth.signOut();s&&n.error(w)},y=async()=>{const s=await t.auth.getSession(),{error:e}=s;return e?await t.auth.getSession():s},U=async s=>{const{data:e,error:r}=await t.auth.updateUser({password:s});if(r)throw r.code==="same_password"&&(n.dismiss(l),n.error("تم إدخال نفس كلمة السر القديمة، برجاء ادخال كلمة سر جديدة")),new o(r.message,r.status,r.code);return e},W=async(s,e)=>await t.from("profiles").update({has_reseted_password:e}).eq("id",s).select().single();export{m as a,h as b,y as g,p as l,U as r,W as s};
