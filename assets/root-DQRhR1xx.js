const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/web-BgjJ_r1V.js","assets/useAttachBackBtn-B740dLZ9.js","assets/chunk-SYFQ2XB5-BeKHOpyI.js","assets/useAuth-CzOvt3ql.js"])))=>i.map(i=>d[i]);
var V=t=>{throw TypeError(t)};var W=(t,e,s)=>e.has(t)||V("Cannot "+s);var r=(t,e,s)=>(W(t,e,"read from private field"),s?s.call(t):e.get(t)),l=(t,e,s)=>e.has(t)?V("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,s),c=(t,e,s,n)=>(W(t,e,"write to private field"),n?n.call(t,s):e.set(t,s),s);var I=(t,e,s,n)=>({set _(a){c(t,e,a,s)},get _(){return r(t,e,n)}});import{S as ue,h as oe,n as d,m as J,M as pe,a as X,b as g,e as ye,c as ge,d as me,f as Pe,o as Y,r as Z,g as ve,i as $,p as ee,s as be,u as ce,j as he,t as N,_ as Oe,A as we,Q as Qe,T as Ae,w as Ee,k as Me}from"./useAuth-CzOvt3ql.js";import{r as x,o as Se,n as o,N as te,p as je,M as qe,L as Ce,S as De,q as xe,O as Fe,t as Le}from"./chunk-SYFQ2XB5-BeKHOpyI.js";import{Q as Te}from"./query-BdAQOJsh.js";import{g as le}from"./auth-CY098ZyE.js";import{P as ke,r as _e,u as Ie,A as Ke}from"./useAttachBackBtn-B740dLZ9.js";const He="/assets/app-h_ETGhys.css";var y,re,Ne=(re=class extends ue{constructor(e={}){super();l(this,y);this.config=e,c(this,y,new Map)}build(e,s,n){const a=s.queryKey,i=s.queryHash??oe(a,s);let h=this.get(i);return h||(h=new Te({cache:this,queryKey:a,queryHash:i,options:e.defaultQueryOptions(s),state:n,defaultOptions:e.getQueryDefaults(a)}),this.add(h)),h}add(e){r(this,y).has(e.queryHash)||(r(this,y).set(e.queryHash,e),this.notify({type:"added",query:e}))}remove(e){const s=r(this,y).get(e.queryHash);s&&(e.destroy(),s===e&&r(this,y).delete(e.queryHash),this.notify({type:"removed",query:e}))}clear(){d.batch(()=>{this.getAll().forEach(e=>{this.remove(e)})})}get(e){return r(this,y).get(e)}getAll(){return[...r(this,y).values()]}find(e){const s={exact:!0,...e};return this.getAll().find(n=>J(s,n))}findAll(e={}){const s=this.getAll();return Object.keys(e).length>0?s.filter(n=>J(e,n)):s}notify(e){d.batch(()=>{this.listeners.forEach(s=>{s(e)})})}onFocus(){d.batch(()=>{this.getAll().forEach(e=>{e.onFocus()})})}onOnline(){d.batch(()=>{this.getAll().forEach(e=>{e.onOnline()})})}},y=new WeakMap,re),m,p,F,ae,Re=(ae=class extends ue{constructor(e={}){super();l(this,m);l(this,p);l(this,F);this.config=e,c(this,m,new Set),c(this,p,new Map),c(this,F,0)}build(e,s,n){const a=new pe({mutationCache:this,mutationId:++I(this,F)._,options:e.defaultMutationOptions(s),state:n});return this.add(a),a}add(e){r(this,m).add(e);const s=K(e);if(typeof s=="string"){const n=r(this,p).get(s);n?n.push(e):r(this,p).set(s,[e])}this.notify({type:"added",mutation:e})}remove(e){if(r(this,m).delete(e)){const s=K(e);if(typeof s=="string"){const n=r(this,p).get(s);if(n)if(n.length>1){const a=n.indexOf(e);a!==-1&&n.splice(a,1)}else n[0]===e&&r(this,p).delete(s)}}this.notify({type:"removed",mutation:e})}canRun(e){const s=K(e);if(typeof s=="string"){const n=r(this,p).get(s),a=n==null?void 0:n.find(i=>i.state.status==="pending");return!a||a===e}else return!0}runNext(e){var n;const s=K(e);if(typeof s=="string"){const a=(n=r(this,p).get(s))==null?void 0:n.find(i=>i!==e&&i.state.isPaused);return(a==null?void 0:a.continue())??Promise.resolve()}else return Promise.resolve()}clear(){d.batch(()=>{r(this,m).forEach(e=>{this.notify({type:"removed",mutation:e})}),r(this,m).clear(),r(this,p).clear()})}getAll(){return Array.from(r(this,m))}find(e){const s={exact:!0,...e};return this.getAll().find(n=>X(s,n))}findAll(e={}){return this.getAll().filter(s=>X(e,s))}notify(e){d.batch(()=>{this.listeners.forEach(s=>{s(e)})})}resumePausedMutations(){const e=this.getAll().filter(s=>s.state.isPaused);return d.batch(()=>Promise.all(e.map(s=>s.continue().catch(g))))}},m=new WeakMap,p=new WeakMap,F=new WeakMap,ae);function K(t){var e;return(e=t.options.scope)==null?void 0:e.id}function se(t){return{onFetch:(e,s)=>{var L,C,T,R,B;const n=e.options,a=(T=(C=(L=e.fetchOptions)==null?void 0:L.meta)==null?void 0:C.fetchMore)==null?void 0:T.direction,i=((R=e.state.data)==null?void 0:R.pages)||[],h=((B=e.state.data)==null?void 0:B.pageParams)||[];let A={pages:[],pageParams:[]},P=0;const v=async()=>{let E=!1;const k=f=>{Object.defineProperty(f,"signal",{enumerable:!0,get:()=>(e.signal.aborted?E=!0:e.signal.addEventListener("abort",()=>{E=!0}),e.signal)})},de=ye(e.options,e.fetchOptions),U=async(f,b,D)=>{if(E)return Promise.reject();if(b==null&&f.pages.length)return Promise.resolve(f);const _={queryKey:e.queryKey,pageParam:b,direction:D?"backward":"forward",meta:e.options.meta};k(_);const fe=await de(_),{maxPages:G}=e.options,z=D?ge:me;return{pages:z(f.pages,fe,G),pageParams:z(f.pageParams,b,G)}};if(a&&i.length){const f=a==="backward",b=f?Be:ne,D={pages:i,pageParams:h},_=b(n,D);A=await U(D,_,f)}else{const f=t??i.length;do{const b=P===0?h[0]??n.initialPageParam:ne(n,A);if(P>0&&b==null)break;A=await U(A,b),P++}while(P<f)}return A};e.options.persister?e.fetchFn=()=>{var E,k;return(k=(E=e.options).persister)==null?void 0:k.call(E,v,{queryKey:e.queryKey,meta:e.options.meta,signal:e.signal},s)}:e.fetchFn=v}}}function ne(t,{pages:e,pageParams:s}){const n=e.length-1;return e.length>0?t.getNextPageParam(e[n],e,s[n],s):void 0}function Be(t,{pages:e,pageParams:s}){var n;return e.length>0?(n=t.getPreviousPageParam)==null?void 0:n.call(t,e[0],e,s[0],s):void 0}var u,O,w,M,S,Q,j,q,ie,Ue=(ie=class{constructor(t={}){l(this,u);l(this,O);l(this,w);l(this,M);l(this,S);l(this,Q);l(this,j);l(this,q);c(this,u,t.queryCache||new Ne),c(this,O,t.mutationCache||new Re),c(this,w,t.defaultOptions||{}),c(this,M,new Map),c(this,S,new Map),c(this,Q,0)}mount(){I(this,Q)._++,r(this,Q)===1&&(c(this,j,Pe.subscribe(async t=>{t&&(await this.resumePausedMutations(),r(this,u).onFocus())})),c(this,q,Y.subscribe(async t=>{t&&(await this.resumePausedMutations(),r(this,u).onOnline())})))}unmount(){var t,e;I(this,Q)._--,r(this,Q)===0&&((t=r(this,j))==null||t.call(this),c(this,j,void 0),(e=r(this,q))==null||e.call(this),c(this,q,void 0))}isFetching(t){return r(this,u).findAll({...t,fetchStatus:"fetching"}).length}isMutating(t){return r(this,O).findAll({...t,status:"pending"}).length}getQueryData(t){var s;const e=this.defaultQueryOptions({queryKey:t});return(s=r(this,u).get(e.queryHash))==null?void 0:s.state.data}ensureQueryData(t){const e=this.defaultQueryOptions(t),s=r(this,u).build(this,e),n=s.state.data;return n===void 0?this.fetchQuery(t):(t.revalidateIfStale&&s.isStaleByTime(Z(e.staleTime,s))&&this.prefetchQuery(e),Promise.resolve(n))}getQueriesData(t){return r(this,u).findAll(t).map(({queryKey:e,state:s})=>{const n=s.data;return[e,n]})}setQueryData(t,e,s){const n=this.defaultQueryOptions({queryKey:t}),a=r(this,u).get(n.queryHash),i=a==null?void 0:a.state.data,h=ve(e,i);if(h!==void 0)return r(this,u).build(this,n).setData(h,{...s,manual:!0})}setQueriesData(t,e,s){return d.batch(()=>r(this,u).findAll(t).map(({queryKey:n})=>[n,this.setQueryData(n,e,s)]))}getQueryState(t){var s;const e=this.defaultQueryOptions({queryKey:t});return(s=r(this,u).get(e.queryHash))==null?void 0:s.state}removeQueries(t){const e=r(this,u);d.batch(()=>{e.findAll(t).forEach(s=>{e.remove(s)})})}resetQueries(t,e){const s=r(this,u),n={type:"active",...t};return d.batch(()=>(s.findAll(t).forEach(a=>{a.reset()}),this.refetchQueries(n,e)))}cancelQueries(t,e={}){const s={revert:!0,...e},n=d.batch(()=>r(this,u).findAll(t).map(a=>a.cancel(s)));return Promise.all(n).then(g).catch(g)}invalidateQueries(t,e={}){return d.batch(()=>{if(r(this,u).findAll(t).forEach(n=>{n.invalidate()}),(t==null?void 0:t.refetchType)==="none")return Promise.resolve();const s={...t,type:(t==null?void 0:t.refetchType)??(t==null?void 0:t.type)??"active"};return this.refetchQueries(s,e)})}refetchQueries(t,e={}){const s={...e,cancelRefetch:e.cancelRefetch??!0},n=d.batch(()=>r(this,u).findAll(t).filter(a=>!a.isDisabled()).map(a=>{let i=a.fetch(void 0,s);return s.throwOnError||(i=i.catch(g)),a.state.fetchStatus==="paused"?Promise.resolve():i}));return Promise.all(n).then(g)}fetchQuery(t){const e=this.defaultQueryOptions(t);e.retry===void 0&&(e.retry=!1);const s=r(this,u).build(this,e);return s.isStaleByTime(Z(e.staleTime,s))?s.fetch(e):Promise.resolve(s.state.data)}prefetchQuery(t){return this.fetchQuery(t).then(g).catch(g)}fetchInfiniteQuery(t){return t.behavior=se(t.pages),this.fetchQuery(t)}prefetchInfiniteQuery(t){return this.fetchInfiniteQuery(t).then(g).catch(g)}ensureInfiniteQueryData(t){return t.behavior=se(t.pages),this.ensureQueryData(t)}resumePausedMutations(){return Y.isOnline()?r(this,O).resumePausedMutations():Promise.resolve()}getQueryCache(){return r(this,u)}getMutationCache(){return r(this,O)}getDefaultOptions(){return r(this,w)}setDefaultOptions(t){c(this,w,t)}setQueryDefaults(t,e){r(this,M).set($(t),{queryKey:t,defaultOptions:e})}getQueryDefaults(t){const e=[...r(this,M).values()],s={};return e.forEach(n=>{ee(t,n.queryKey)&&Object.assign(s,n.defaultOptions)}),s}setMutationDefaults(t,e){r(this,S).set($(t),{mutationKey:t,defaultOptions:e})}getMutationDefaults(t){const e=[...r(this,S).values()];let s={};return e.forEach(n=>{ee(t,n.mutationKey)&&(s={...s,...n.defaultOptions})}),s}defaultQueryOptions(t){if(t._defaulted)return t;const e={...r(this,w).queries,...this.getQueryDefaults(t.queryKey),...t,_defaulted:!0};return e.queryHash||(e.queryHash=oe(e.queryKey,e)),e.refetchOnReconnect===void 0&&(e.refetchOnReconnect=e.networkMode!=="always"),e.throwOnError===void 0&&(e.throwOnError=!!e.suspense),!e.networkMode&&e.persister&&(e.networkMode="offlineFirst"),e.queryFn===be&&(e.enabled=!1),e}defaultMutationOptions(t){return t!=null&&t._defaulted?t:{...r(this,w).mutations,...(t==null?void 0:t.mutationKey)&&this.getMutationDefaults(t.mutationKey),...t,_defaulted:!0}}clear(){r(this,u).clear(),r(this,O).clear()}},u=new WeakMap,O=new WeakMap,w=new WeakMap,M=new WeakMap,S=new WeakMap,Q=new WeakMap,j=new WeakMap,q=new WeakMap,ie);function Ge(){const{setUser:t,user:e}=ce();x.useEffect(()=>{const{data:s}=he.auth.onAuthStateChange(async(n,a)=>{if(n==="SIGNED_OUT")return t(null);const i=a==null?void 0:a.user;if(!i||i.id===(e==null?void 0:e.id))return;const h=await le(i.id);t(h)});return()=>s.subscription.unsubscribe()},[])}function ze({children:t}){const[e,s]=x.useState(!0),{user:n,setUser:a}=ce();x.useEffect(()=>{(async()=>{var C;const{data:P}=await he.auth.getSession(),v=(C=P==null?void 0:P.session)==null?void 0:C.user,L=(v==null?void 0:v.id)===(n==null?void 0:n.id);if(!v)a(null);else if(!L){const T=await le(v.id);a(T)}s(!1)})()},[]),Ge();const{pathname:i}=Se(),h=i==="/login";return e?o.jsx(ke,{}):n?h?o.jsx(te,{to:"/",replace:!0}):t:h?t:o.jsx(te,{to:"/login",replace:!0})}const H=()=>{N.dismiss(),navigator.onLine||N.error("No internet connection"),navigator.onLine&&N.success("Connection Restored")},Ve=_e("SplashScreen",{web:()=>Oe(()=>import("./web-BgjJ_r1V.js"),__vite__mapDeps([0,1,2,3])).then(t=>new t.SplashScreenWeb)});function We({children:t}){const e=new Ue({defaultOptions:{queries:{refetchOnWindowFocus:!1}}});x.useEffect(()=>(window.addEventListener("online",H),window.addEventListener("offline",H),()=>{window.removeEventListener("online",H),window.removeEventListener("offline",H)}),[]),x.useEffect(()=>{const n=()=>{Ve.hide()};return n(),document.addEventListener("DOMContentLoaded",n),()=>document.removeEventListener("DOMContentLoaded",n)},[]);const s=je();return Ie(({canGoBack:n})=>{const a=document.body;a.querySelector("span[data-radix-focus-guard]")||a.getAttribute("data-scroll-locked")==="1"||(n?s(-1):Ke.minimizeApp())},[]),o.jsx(we,{children:o.jsx(ze,{children:o.jsxs(Qe,{client:e,children:[o.jsx("div",{className:"h-screen w-screen overflow-hidden",children:t}),o.jsx(Ae,{richColors:!0,position:"top-left",theme:"light",closeButton:!0})]})})})}const tt=()=>[{rel:"preconnect",href:"https://fonts.googleapis.com"},{rel:"preconnect",href:"https://fonts.gstatic.com",crossOrigin:"anonymous"},{rel:"stylesheet",href:"https://fonts.googleapis.com/css2?family=Alexandria:wght@100..900&display=swap"},{rel:"stylesheet",href:He}];function st({children:t}){return o.jsxs("html",{lang:"ar",dir:"rtl",children:[o.jsxs("head",{children:[o.jsx("meta",{charSet:"utf-8"}),o.jsx("meta",{name:"viewport",content:"width=device-width, initial-scale=1"}),o.jsx(qe,{}),o.jsx(Ce,{})]}),o.jsxs("body",{className:"h-screen w-screen",children:[t,o.jsx(De,{}),o.jsx(xe,{})]})]})}const nt=Ee(function(){return o.jsx(We,{children:o.jsx(Fe,{})})}),rt=Me(function({error:e}){let s="Oops!",n="An unexpected error occurred.",a;return Le(e)&&(s=e.status===404?"404":"Error",n=e.status===404?"The requested page could not be found.":e.statusText||n),o.jsxs("main",{className:"container mx-auto p-4 pt-16",children:[o.jsx("h1",{children:s}),o.jsx("p",{children:n}),a]})});export{rt as ErrorBoundary,st as Layout,nt as default,tt as links};
