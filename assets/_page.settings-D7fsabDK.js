import{r as x,A as j,p as s,w as _}from"./chunk-PVWAREVJ-DbUQBqSc.js";import{C as y}from"./ConfirmModal-DLK1UtK1.js";import{u as F}from"./input-CSC9h8Uv.js";import{u as N,$ as P,l as S}from"./QueryClientProvider-BqTx5ubc.js";import{u as B,f as E}from"./index.esm-BiZX3RZs.js";import{I as d}from"./InputField-C3YZrV8p.js";import{c as k}from"./schemas-Cyb-5gAU.js";import"./Modal-l_hH5ou8.js";import"./X-pPIl1Lk2.js";import"./Input-C7r7KRm1.js";function I(){var p;const{authData:a}=N(),g=(p=a==null?void 0:a.user)==null?void 0:p.email,[m,i]=x.useState(!1),c=B({initialValues:{current_password:"",password:"",confirm_password:""},validationSchema:k,onSubmit:({current_password:e,password:r})=>C({email:g,current_password:e,password:r})}),{handleBlur:t,handleChange:n,handleSubmit:w,submitForm:h,values:l,resetForm:u,setFieldError:v}=c;x.useEffect(()=>{u()},[m,u]);const b=j(),{mutate:C,isPending:o}=F({mutationFn:P,onSuccess:async()=>{await S(),b("/"),i(!1)},onError:e=>{const{code:r,statusCode:f}=e;(f===400&&r==="invalid_credentials"||f===406&&r==="PGRST116")&&v("current_password","كلمة المرور الحالية غير صحيحة")}});return s.jsx(y,{toggle:()=>i(e=>!e),isOpen:m,isActionsDisabled:o,title:"إعادة تعيين كلمة السر",trigger:s.jsx("span",{className:"text-lg font-semibold text-primary underline-offset-8 hover:underline",children:"تغيير كلمة السر"}),confirmCallBack:h,cancelCallBack:()=>i(!1),confirmLabel:"تأكيد",children:s.jsx(E,{value:c,children:s.jsxs("form",{onSubmit:w,className:"flex w-full flex-1 flex-col gap-3 overflow-auto px-1",children:[s.jsx(d,{className:"[&>div]:border-primary/50 [&>div]:transition",name:"current_password",label:"كلمة السر الحالية",type:"password",disabled:o,autoComplete:"one-time-code",autoFocus:!0,value:l.current_password,onChange:n,onBlur:t}),s.jsx(d,{className:"[&>div]:border-primary/50 [&>div]:transition",name:"password",label:"كلمة السر الجديدة",type:"password",disabled:o,autoComplete:"one-time-code",value:l.password,onChange:n,onBlur:t}),s.jsx(d,{className:"[&>div]:border-primary/50 [&>div]:transition",name:"confirm_password",label:"تأكيد كلمة السر الجديدة",type:"password",disabled:o,autoComplete:"one-time-code",value:l.confirm_password,onChange:n,onBlur:t})]})})})}const z=_(function(){return s.jsx("ul",{className:"list-disc py-4 max-sm:px-7",children:s.jsx("li",{className:"list-inside list-disc",children:s.jsx(I,{})})})});export{z as default};
