import{p as s,r as p,w as b}from"./chunk-PVWAREVJ-DAoB9U7O.js";import{B as N}from"./Button-DcXjmR0v.js";import{C as w,P as y,a as E,c as R}from"./PatientCard-4TP0_Bq3.js";import{F as j}from"./Delete-CxpYUATw.js";import{Q as F,e as O,R as M}from"./RenderData-CYTe3UVr.js";import{c as C}from"./QueryClientProvider-D8tzuESK.js";import{i as x,h as I,a as k}from"./infiniteQueryBehavior-B4FD7ohj.js";import{u as v}from"./usePageContext-D3j3abi8.js";import{e as Q}from"./patient-CzicXjoZ.js";import"./input-C6m9RNVH.js";import"./index.esm-C3qyIEbc.js";import"./PageLoader-CyDSEzCM.js";import"./InputField-6TQYouxC.js";import"./Input-BvMYqO-D.js";import"./Pencil-BtnxADMP.js";import"./time-CDh3KrcT.js";import"./Modal-DIgg9v5H.js";import"./X-CTHKRN_i.js";import"./ConfirmModal-Dwz3wsMH.js";import"./label-DWvZDU_2.js";import"./PageContext-CzIsZXuJ.js";import"./query-ChmUlf2E.js";var A=class extends F{constructor(e,t){super(e,t)}bindMethods(){super.bindMethods(),this.fetchNextPage=this.fetchNextPage.bind(this),this.fetchPreviousPage=this.fetchPreviousPage.bind(this)}setOptions(e){super.setOptions({...e,behavior:x()})}getOptimisticResult(e){return e.behavior=x(),super.getOptimisticResult(e)}fetchNextPage(e){return this.fetch({...e,meta:{fetchMore:{direction:"forward"}}})}fetchPreviousPage(e){return this.fetch({...e,meta:{fetchMore:{direction:"backward"}}})}createResult(e,t){var P,g;const{state:r}=e,n=super.createResult(e,t),{isFetching:o,isRefetching:c,isError:h,isRefetchError:d}=n,u=(g=(P=r.fetchMeta)==null?void 0:P.fetchMore)==null?void 0:g.direction,f=h&&u==="forward",m=o&&u==="forward",a=h&&u==="backward",l=o&&u==="backward";return{...n,fetchNextPage:this.fetchNextPage,fetchPreviousPage:this.fetchPreviousPage,hasNextPage:k(t,r.data),hasPreviousPage:I(t,r.data),isFetchNextPageError:f,isFetchingNextPage:m,isFetchPreviousPageError:a,isFetchingPreviousPage:l,isRefetchError:d&&!f&&!a,isRefetching:c&&!m&&!l}}};function T(e,t){return O(e,A)}function B({className:e}){return s.jsx("div",{className:C("inline-block w-full animate-spin rounded-full border-2 border-primary border-t-transparent",e)})}function _({pageSize:e}){const{search:t}=v(),[r,n]=p.useState(1),o=T({initialPageParam:!!r,queryKey:["patients",t],queryFn:({signal:c})=>Q(t,r,e,c),getNextPageParam:({count:c})=>{const h=Math.ceil(c/e);return r<h||void 0},getPreviousPageParam:()=>r===1&&void 0});return p.useEffect(()=>{n(1)},[t]),{...o,page:r,setPage:n}}const oe=b(function(){const{addNewOpen:t,setAddNewOpen:r}=v(),{isPending:n,data:o,refetch:c,isError:h,hasNextPage:d,fetchNextPage:u,setPage:f,isFetchingNextPage:m}=_({pageSize:15}),a=o==null?void 0:o.pages.flatMap(i=>i.data),l=(a==null?void 0:a.length)===0;return s.jsxs(s.Fragment,{children:[s.jsx(M,{isEmpty:l,isFetching:n,isError:h,children:s.jsx("div",{className:"flex h-full flex-col gap-3 overflow-auto max-sm:pb-3.5",children:s.jsxs(w,{className:"flex-1",children:[a==null?void 0:a.map(i=>s.jsx(y,{variant:E.PATIENT,patient:i},i==null?void 0:i.id)),d&&s.jsx(N,{variant:"secondary",className:"col-span-full mx-auto my-1 flex w-full items-center justify-center rounded-lg border-slate-300 p-1.5 text-sm text-slate-600 shadow-md hover:text-primary hover:shadow-sm disabled:bg-background disabled:hover:bg-transparent max-sm:w-11/12 sm:w-1/3",onClick:()=>{f(i=>i+1),u()},disabled:!d||m,type:"button",children:m?s.jsx(B,{className:"size-6"}):"تحميل المزيد"})]})})}),s.jsx(j,{title:"إضافة مريض",isOpen:t,setIsOpen:r,className:"",children:s.jsx(R,{setIsOpen:r,refetch:c})})]})});export{oe as default};
