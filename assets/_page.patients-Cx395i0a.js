import{p as s,r as p,w as N}from"./chunk-PVWAREVJ-DbUQBqSc.js";import{B as b}from"./Button-CX5LaLF9.js";import{C as w,P as y,a as E,c as R}from"./PatientCard-DshMSI-V.js";import{F as j}from"./Delete-Bxs4hycU.js";import{Q as F,e as O,R as M}from"./RenderData-C-saR8Bk.js";import{c as C}from"./QueryClientProvider-B0e4pmks.js";import{i as x,h as I,a as k}from"./infiniteQueryBehavior-BwPRIPzL.js";import{u as v}from"./usePageContext-BKn3lOPF.js";import{e as Q}from"./patient-BK1TNs0r.js";import"./input-D3y1GKQf.js";import"./index.esm-C0DY_CMF.js";import"./PageLoader-DZP7-pmZ.js";import"./InputField-Bsv0isQJ.js";import"./Input-D675VA38.js";import"./Pencil-B49a0cmu.js";import"./time-CDh3KrcT.js";import"./query-eic4WXM_.js";import"./label-Ev8ME_t6.js";import"./PageContext-CweN0xE8.js";var A=class extends F{constructor(e,t){super(e,t)}bindMethods(){super.bindMethods(),this.fetchNextPage=this.fetchNextPage.bind(this),this.fetchPreviousPage=this.fetchPreviousPage.bind(this)}setOptions(e){super.setOptions({...e,behavior:x()})}getOptimisticResult(e){return e.behavior=x(),super.getOptimisticResult(e)}fetchNextPage(e){return this.fetch({...e,meta:{fetchMore:{direction:"forward"}}})}fetchPreviousPage(e){return this.fetch({...e,meta:{fetchMore:{direction:"backward"}}})}createResult(e,t){var P,g;const{state:r}=e,n=super.createResult(e,t),{isFetching:o,isRefetching:c,isError:h,isRefetchError:f}=n,u=(g=(P=r.fetchMeta)==null?void 0:P.fetchMore)==null?void 0:g.direction,m=h&&u==="forward",d=o&&u==="forward",a=h&&u==="backward",l=o&&u==="backward";return{...n,fetchNextPage:this.fetchNextPage,fetchPreviousPage:this.fetchPreviousPage,hasNextPage:k(t,r.data),hasPreviousPage:I(t,r.data),isFetchNextPageError:m,isFetchingNextPage:d,isFetchPreviousPageError:a,isFetchingPreviousPage:l,isRefetchError:f&&!m&&!a,isRefetching:c&&!d&&!l}}};function T(e,t){return O(e,A)}function B({className:e}){return s.jsx("div",{className:C("inline-block w-full animate-spin rounded-full border-2 border-primary border-t-transparent",e)})}function _({pageSize:e}){const{search:t}=v(),[r,n]=p.useState(1),o=T({initialPageParam:!!r,queryKey:["patients",t],queryFn:({signal:c})=>Q(t,r,e,c),getNextPageParam:({count:c})=>{const h=Math.ceil(c/e);return r<h||void 0},getPreviousPageParam:()=>r===1&&void 0});return p.useEffect(()=>{n(1)},[t]),{...o,page:r,setPage:n}}const se=N(function(){const{addNewOpen:t,setAddNewOpen:r}=v(),{isPending:n,data:o,refetch:c,isError:h,hasNextPage:f,fetchNextPage:u,setPage:m,isFetchingNextPage:d}=_({pageSize:15}),a=o==null?void 0:o.pages.flatMap(i=>i.data),l=(a==null?void 0:a.length)===0;return s.jsxs(s.Fragment,{children:[s.jsx(M,{isEmpty:l,isFetching:n,isError:h,children:s.jsx("div",{className:"flex h-full flex-col gap-3 overflow-auto",children:s.jsxs(w,{className:"flex-1",children:[a==null?void 0:a.map(i=>s.jsx(y,{variant:E.PATIENT,patient:i},i==null?void 0:i.id)),f&&s.jsx(b,{variant:"secondary",className:"col-span-full mx-auto my-1 flex w-full items-center justify-center rounded-lg border-slate-300 p-1.5 text-sm text-slate-600 shadow-md hover:text-primary hover:shadow-sm disabled:bg-background disabled:hover:bg-transparent sm:w-1/3",onClick:()=>{m(i=>i+1),u()},disabled:!f||d,children:d?s.jsx(B,{className:"size-6"}):"تحميل المزيد"})]})})}),s.jsx(j,{title:"إضافة مريض",isOpen:t,setIsOpen:r,className:"",children:s.jsx(R,{setIsOpen:r,refetch:c})})]})});export{se as default};
