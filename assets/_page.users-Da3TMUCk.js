import{r as u,p as e,w as f}from"./chunk-PVWAREVJ-chYXeG9N.js";import{C as g,D as x,u as h,R as y,a as j}from"./Delete-CW52lOLR.js";import{l as d,t as C,q as A,j as w,u as b}from"./QueryClientProvider-b9r43jxz.js";import{T as q}from"./Table-DS8CBWOe.js";import{X as N}from"./X-CjFVNX7j.js";import{u as _}from"./utils-k7BbqiBD.js";import{P as v}from"./PageContext-BJHu0vOw.js";import"./query-A0VTYRIv.js";import"./useAttachBackBtn-n1K_AgdM.js";import"./button-DopYWWVj.js";import"./index-DpT_dJLM.js";const{success:{user:{delete:D}}}=A,K=async()=>await d.from("profiles").select("*"),P=async a=>{const n=await d.from("profiles").delete().eq("id",a).select(),{error:o}=n;if(!o)C.success(D);else throw new Error(o.message,{cause:n})};function k({userId:a}){const n=w(),[o,s]=u.useState(!1),{mutate:i,isPending:t}=_({mutationFn:P,onSuccess:()=>{n.invalidateQueries({queryKey:["doctor_availability"]})}});return e.jsx(g,{toggle:()=>s(l=>!l),isOpen:o,isActionsDisabled:t,title:"حذف مستخدم",trigger:e.jsx(x,{className:"size-6 fill-red-600"}),confirmCallBack:()=>i(a),cancelCallBack:()=>s(!1),children:e.jsx("p",{children:"هل أنت متأكد من حذف هذا المستخدم"})})}const V=f(function(){const{addNewOpen:n,setAddNewOpen:o}=u.useContext(v);b();const{data:s,isFetching:i}=h({queryKey:["users"],queryFn:K}),t=(s==null?void 0:s.data)??[],l=(t==null?void 0:t.length)===0,p=[{accessorKey:"name",header:"الاسم"},{accessorKey:"role",header:"الوظيفة",cell:({row:r})=>r.getValue("role")==="doctor"?"طبيب":"ممرض"},{accessorKey:"is_admin",header:"Admin",cell:({row:r})=>r.getValue("is_admin")?e.jsx(j,{className:"stroke-green-600"}):e.jsx(N,{className:"fill-red-600"})},{header:"تعديل",cell:({row:r})=>{const c=r.original.id,m=r.original.is_admin;return e.jsx("div",{className:"flex items-center gap-1",children:!m&&e.jsx(k,{userId:c})})}}];return e.jsx(e.Fragment,{children:e.jsx(y,{isEmpty:l,isFetching:i,children:e.jsx(q,{data:t??[],columns:p})})})});export{V as default};
