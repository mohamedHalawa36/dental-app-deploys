import{r as x,t as j,p as s,w as _}from"./chunk-PVWAREVJ-DAoB9U7O.js";import{C as y}from"./ConfirmModal-Dwz3wsMH.js";import{u as F}from"./input-C6m9RNVH.js";import{u as N,q as P,a0 as S,l as B}from"./QueryClientProvider-D8tzuESK.js";import{u as E,f as k}from"./index.esm-C3qyIEbc.js";import{I as d}from"./InputField-6TQYouxC.js";import{c as I}from"./schemas-DReeLMkN.js";import"./Modal-DIgg9v5H.js";import"./X-CTHKRN_i.js";import"./Input-BvMYqO-D.js";function M(){var p;const{authData:a}=N(),g=(p=a==null?void 0:a.user)==null?void 0:p.email,[m,i]=x.useState(!1),c=E({initialValues:{current_password:"",password:"",confirm_password:""},validationSchema:I,onSubmit:({current_password:e,password:r})=>C({email:g,current_password:e,password:r})}),{handleBlur:t,handleChange:n,handleSubmit:v,submitForm:w,values:l,resetForm:u,setFieldError:h}=c;x.useEffect(()=>{u()},[m,u]);const b=j(),{mutate:C,isPending:o}=F({mutationFn:S,onSuccess:async()=>{await B(),b("/"),i(!1)},onError:e=>{const{code:r,statusCode:f}=e;(f===400&&r==="invalid_credentials"||f===406&&r==="PGRST116")&&h("current_password","كلمة المرور الحالية غير صحيحة")}});return s.jsx(y,{toggle:()=>i(e=>!e),isOpen:m,isActionsDisabled:o,title:"إعادة تعيين كلمة السر",trigger:s.jsx("span",{className:"text-lg font-semibold text-primary underline-offset-8 hover:underline",children:"تغيير كلمة السر"}),confirmCallBack:w,cancelCallBack:()=>i(!1),confirmLabel:"تأكيد",cancelLabel:"إلغاء",children:s.jsx(k,{value:c,children:s.jsxs("form",{onSubmit:v,className:"flex w-full flex-1 flex-col gap-3 overflow-auto px-1",children:[s.jsx(d,{className:"[&>div]:border-primary/50 [&>div]:transition",name:"current_password",label:"كلمة السر الحالية",type:"password",disabled:o,autoComplete:"one-time-code",autoFocus:!P(),value:l.current_password,onChange:n,onBlur:t}),s.jsx(d,{className:"[&>div]:border-primary/50 [&>div]:transition",name:"password",label:"كلمة السر الجديدة",type:"password",disabled:o,autoComplete:"one-time-code",value:l.password,onChange:n,onBlur:t}),s.jsx(d,{className:"[&>div]:border-primary/50 [&>div]:transition",name:"confirm_password",label:"تأكيد كلمة السر الجديدة",type:"password",disabled:o,autoComplete:"one-time-code",value:l.confirm_password,onChange:n,onBlur:t})]})})})}const H=_(function(){return s.jsx("ul",{className:"list-disc py-4 max-sm:px-7",children:s.jsx("li",{className:"list-inside list-disc",children:s.jsx(M,{})})})});export{H as default};
